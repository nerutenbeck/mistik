panel.background=element_blank())
photo.plot
mistik$light<-factor(ifelse(mistik$PARi>1100,'1200 mmol PPFD','50 mmol PPFD'))
photo.mer<-lmer(sqrt(photo)~light*species*gappos*vegtrt+(1|block/transect/gappos/treenum),
data=mistik,REML=T)
rplot(photo.mer)
qqnorm(resid(photo.mer));qqline(resid(photo.mer))
qplot(resid(photo.mer),binwidth=0.1)
plot(sqrt(mistik$photo)~fitted(photo.mer));abline(0,1)
photo.aov<-Anova(photo.mer,type=2,test.statistic='F')
photo.aov
photo.lsm<-ldply(lsmeans(photo.mer,
specs='pairwise~light*species*gappos|light:vegtrt:species')[1])[-1]
photo.lsm
photo.plot<-ggplot(photo.lsm,aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lsmean-SE)^2)>0,I((lsmean-SE)^2),0),
ymax=I((lsmean+SE)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.+light~vegtrt)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,25)+
ylab(expression(" A ("*mu*"mol "*CO[2]*" "*m^2*" "*s^-1*""))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
photo.plot
photo.plot<-ggplot(photo.lsm,aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lsmean-SE)^2)>0,I((lsmean-SE)^2),0),
ymax=I((lsmean+SE)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.+light~vegtrt)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,25)+
ylab(expression(" A ("*mu*"mol "*CO[2]*" "*m^2*" "*s^-1*")"))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
photo.plot
photo.plot<-ggplot(photo.lsm,aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lsmean-SE)^2)>0,I((lsmean-SE)^2),0),
ymax=I((lsmean+SE)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.+light~vegtrt)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,25)+
ylab(expression(" A ("*mu*"mol "*CO[2]*" "*m^-2*" "*s^-1*")"))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
photo.plot
cond.mer<-lmer(sqrt(cond)~light*species*gappos*vegtrt+(1|block/transect/gappos/treenum),
data=mistik,REML=T)
rplot(cond.mer) # may be a few outliers, but not sure whether to toss them or not...
qqnorm(resid(cond.mer));qqline(resid(cond.mer))
qplot(resid(cond.mer),binwidth=0.01)
cond.aov<-Anova(cond.mer,type=2,test.statistic='F')
cond.aov
cond.lsm<-ldply(lsmeans(cond.mer,
specs='pairwise~light*species*gappos|light:vegtrt:species')[1])[-1]
cond.lsm
cond.plot<-ggplot(cond.lsm,aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lsmean-SE)^2)>0,I((lsmean-SE)^2),0),
ymax=I((lsmean+SE)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.+light~vegtrt)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,0.5)+
ylab(expression(""*g[sw]*" ("*mu*"mol "*CO[2]*" "*m^-2*" "*s^-1*")"))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
cond.plot
trmmol.mer<-lmer(sqrt(trmmol)~light*species*gappos*vegtrt+(1|block/transect/gappos/treenum),
data=mistik,REML=T)
rplot(trmmol.mer)
qqnorm(resid(trmmol.mer));qqline(resid(trmmol.mer))
qplot(resid(trmmol.mer),binwidth=0.05)
plot(sqrt(mistik$trmmol)~fitted(trmmol.mer));abline(0,1)
trmmol.aov<-Anova(trmmol.mer,type=2,test.statistic='F')
trmmol.aov
trmmol.lsm<-ldply(lsmeans(photo.mer,
specs='pairwise~light*species*gappos|light:vegtrt:species')[1])[-1]
trmmol.lsm
trmmol.plot<-ggplot(trmmol.lsm,aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lsmean-SE)^2)>0,I((lsmean-SE)^2),0),
ymax=I((lsmean+SE)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.+light~vegtrt)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,30)+
ylab(expression(""*mu*"mol "*H[2]*"O "*m^2*" "*s^-1*""))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
trmmol.plot
save.image()
ran<-as.data.frame(rbind(sigma.hat(photo.mer)$sigma,
sigma.hat(cond.mer)$sigma,
sigma.hat(trmmol.mer)$sigma))[,c(5,4,3,2,1)]
ran
names(ran)<-c('Block','Transect','Plot','Tree','Residual')
ran
row.names(ran)<-c('Photosynthesis','Conductance','Transpiration')
ran
save.image()
trmmol.aov
trmmol.lsm
trmmol.lsm<-ldply(lsmeans(photo.mer,
specs='pairwise~light*species*gappos')[1])[-1]
trmmol.lsm
trmmol.aov
trmmol.mer2<-update(trmmol.mer,.~.-vegtrt-light:vegtrt-species:vegtrt-
gappos:vegtrt-light:species:vegtrt-light:gappos:vegtrt-
species:gappos:vegtrt-light:species:gappos:vegtrt)
trmmol.lsm<-ldply(lsmeans(trmmol.mer2,
specs='pairwise~light*species*gappos')[1])[-1]
trmmol.lsm
trmmol.plot<-ggplot(trmmol.lsm,aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lsmean-SE)^2)>0,I((lsmean-SE)^2),0),
ymax=I((lsmean+SE)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.+light)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,25)+
ylab(expression(""*mu*"mol "*H[2]*"O "*m^2*" "*s^-1*""))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
trmmol.plot<-ggplot(trmmol.lsm,aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lsmean-SE)^2)>0,I((lsmean-SE)^2),0),
ymax=I((lsmean+SE)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.~light)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,25)+
ylab(expression(""*mu*"mol "*H[2]*"O "*m^2*" "*s^-1*""))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
trmmol.plot
trmmol.plot<-ggplot(trmmol.lsm,aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lsmean-SE)^2)>0,I((lsmean-SE)^2),0),
ymax=I((lsmean+SE)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.~light)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,5)+
ylab(expression(""*mu*"mol "*H[2]*"O "*m^2*" "*s^-1*""))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
trmmol.plot
cond.aov
photo.aov
trmmol.aov2<-Anova(trmmol.mer2,type=2,test.statistic='F')
trmmol.aov2
save.image
save.image)()
save.image()
trmmol.aov2
trmmol.aov
cond.plot
photo.aov
cond.aov
photo.plot
photo.lsm<-lsmeans(photo.mer,specs='pairwise~light*species*gappos|light:vegtrt:species')
trmmol.lsm<-lsmeans(trmmol.mer2,specs='pairwise~light*species*gappos')
cond.lsm<-lsmeans(cond.mer,specs='pairwise~light*species*gappos|light:vegtrt:species')
trmmol.lsm
trmmol.lsm
trmmol.plot+geom_text('a')
trmmol.plot+annotate('a')
trmmol.plot+annotate(text,'a')
trmmol.plot+annotate(text,x='a')
trmmol.plot<-ggplot(ldply(trmmol.lsm[1])[-1],aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lsmean-SE)^2)>0,I((lsmean-SE)^2),0),
ymax=I((lsmean+SE)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.~light)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,5)+
ylab(expression(""*mu*"mol "*H[2]*"O "*m^2*" "*s^-1*""))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())+
theme(legend.text=c('P. glauca','P. tremuloides'))
trmmol.plot+annotate('text',x=1,label='a')
trmmol.plot+annotate('text',x=1,y=5label='a')
trmmol.plot+annotate('text',x=1,y=5,label='a')
trmmol.plot
ran
ran<-as.data.frame(rbind(sigma.hat(photo.mer)$sigma^2,
sigma.hat(cond.mer)$sigma^2,
sigma.hat(trmmol.mer)$sigma^2))[,c(5,4,3,2,1)]
ran^2
I(ran^2)
c(1,2,3)^2
ran[1]
ran[[1]]
as.numeric(ran[[1]])
as.numeric(ran)
for(i in 1:length(ran)){
ran[i]<-as.numeric(ran[[i]])
}
ran
ran^2
for(i in 1:length(ran)){
ran[i]<-as.numeric(ran[[i]]^2)
}
ran
save.image()
photo.aov
photo.aov[15,4]
round()
digits()
round(5.423678,2)
round(5.423678,4)
trmmol.aov
photo.plot
cond.plot
trmmol.plot
cond.plot
photo.plot
cond.plot
trmmol.plot
head(mistik)
qplot(x=sla,data=LA,binwidth=10)+facet_wrap(~species)
library(Hmisc)
install.packages('Hmisc')
rplot<-function(model){
plot(fitted(model)~resid(model),pch=20)
}
rplot(la.mer)
rplot<-function(model){
plot(fitted(model)~resid(model),pch=20)
abline(0,0,lty=2)
}
rplot(la.mer)
rplot<-function(model){
plot(fitted(model)~resid(model),pch=20);abline(0,0,lty=2)
}
rplot(la.mer)
rplot<-function(model){
plot(resid(model)~fitted(model),pch=20);abline(0,0,lty=2)
}
rplot(la.mer)
rplot<-function(model){
plot(resid(model)~fitted(model),pch=20,cex=0.8);abline(0,0,lty=2)
}
rplot(la.mer)
rplot<-function(model){
plot(resid(model)~fitted(model),pch=20,cex=0.7);abline(0,0,lty=2)
}
rplot(la.mer)
rplot<-function(model){
plot(resid(model)~fitted(model),pch=20,cex=0.75);abline(0,0,lty=2)
}
rplot(la.mer)
rplot<-function(model){
plot(resid(model)~fitted(model),pch=20,cex=0.8);abline(0,0,lty=2)
}
rplot(la.mer)
photo.plot
cond.plot
trmmol.plot
cond.plot
photo.plot
cond.plot
photo.lsm
photo.plot2<-ggplot(ldply(photo.lsm[1])[-1],aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lower.CL)^2)>0,I((lower.CL)^2),0),
ymax=I((upper.CL)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.+light~vegtrt)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,25)+
ylab(expression(" A ("*mu*"mol "*CO[2]*" "*m^-2*" "*s^-1*")"))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
photo.plot2
library(ggplot2)
library(lsmeans)
photo.plot2<-ggplot(ldply(photo.lsm[1])[-1],aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lower.CL)^2)>0,I((lower.CL)^2),0),
ymax=I((upper.CL)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.+light~vegtrt)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,25)+
ylab(expression(" A ("*mu*"mol "*CO[2]*" "*m^-2*" "*s^-1*")"))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
photo.plot2
library(plyr)
library(reshape2)
photo.plot2<-ggplot(ldply(photo.lsm[1])[-1],aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lower.CL)^2)>0,I((lower.CL)^2),0),
ymax=I((upper.CL)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.+light~vegtrt)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,25)+
ylab(expression(" A ("*mu*"mol "*CO[2]*" "*m^-2*" "*s^-1*")"))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
photo.plot2
photo.plot2<-ggplot(ldply(photo.lsm[1])[-1],aes(x=gappos,y=I(lsmean^2),
ymin=ifelse(I((lower.CL)^2)>0,I((lower.CL)^2),0),
ymax=I((upper.CL)^2),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
facet_grid(.+light~vegtrt)+scale_fill_grey()+
xlab("Gap Position")+ylim(0,40)+
ylab(expression(" A ("*mu*"mol "*CO[2]*" "*m^-2*" "*s^-1*")"))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_rect(color='black'),
panel.background=element_blank())
photo.plot2
photo.plot
cond.lsm
trmmol.lsm
trmmol.lsm<-lsmeans(trmmol.mer2,specs='pairwise~light*species*gappos|light')
LA.lsm
la.lsm<-lsmeans(la.mer,specs='pairwise~species*gappos')
library(arm)
la.lsm<-lsmeans(la.mer,specs='pairwise~species*gappos')
la.lsm
la.plot
set.seed(1)
df <- data.frame(x=rnorm(300), y=rnorm(300), cl=gl(3,100))   # create test data
df.cor <- ddply(df, .(cl), function(val) sprintf("rho==%.2f", cor(val$x, val$y)))
p1 <- ggplot(data=df, aes(x=x)) +
geom_point(aes(y=y, colour="col1", alpha=0.4)) +
facet_wrap(~ cl, ncol=3) +
geom_text(data=df.cor, aes(x=0, y=3, label=V1), parse=TRUE) +
scale_colour_manual(values=c("col1"="red")) +
opts(legend.position="none")
print(p1)
head(la.lsm)
ldply(la.lsm[1])[-1]
la.means<-ldply(la.lsm[1])[-1]
la.means$sym<-rep(NA,nrow(la.means))
la.plot
la.means$sym<-c('a','d','ab','de','bc','e','c','de')
la.means
la.plot<-ggplot(ldply(la.lsm[1])[-1],
aes(x=gappos,y=exp(lsmean),
ymin=ifelse(exp(lsmean-SE)>0,exp(lsmean-SE),0),
ymax=exp(lsmean+SE),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
scale_fill_grey()+
geom_text(aes(label=sym),parse=T)+
xlab("Gap Position")+
ylab(expression(""*cm^2*"/g"))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank())
la.plot
la.plot<-ggplot(la.means,
aes(x=gappos,y=exp(lsmean),
ymin=ifelse(exp(lsmean-SE)>0,exp(lsmean-SE),0),
ymax=exp(lsmean+SE),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
scale_fill_grey()+
geom_text(aes(label=sym),parse=T)+
xlab("Gap Position")+
ylab(expression(""*cm^2*"/g"))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank())
la.plot
la.plot<-ggplot(la.means,
aes(x=gappos,y=exp(lsmean),
ymin=ifelse(exp(lsmean-SE)>0,exp(lsmean-SE),0),
ymax=exp(lsmean+SE),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
scale_fill_grey()+
geom_text(aes(label=sym),parse=T, position=position_dodge(width=0.9))+
xlab("Gap Position")+
ylab(expression(""*cm^2*"/g"))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank())
la.plot
la.plot<-ggplot(la.means,
aes(x=gappos,y=exp(lsmean),
ymin=ifelse(exp(lsmean-SE)>0,exp(lsmean-SE),0),
ymax=exp(lsmean+SE),
fill=species))+
geom_bar(stat='identity',position='dodge')+
geom_errorbar(width=0.4,position=position_dodge(width=0.9))+
scale_fill_grey()+
geom_text(aes(label=sym,y=exp(lsmean+SE)+10),
parse=T, position=position_dodge(width=0.9))+
xlab("Gap Position")+
ylab(expression(""*cm^2*"/g"))+
theme_bw()+
theme(axis.line=element_line(color='black'),
panel.grid.major=element_blank(),
panel.grid.minor=element_blank(),
panel.border=element_blank(),
panel.background=element_blank())
la.plot
la.lsm
10+21
22+88
e<-6
e
eleanor<-6
eleanor
magpie<-4
eleanor+magpie
papa<-32
eleanor+magpie+papa
mama<-34
eleanor+magpie+papa+mama
mama-papa
rm('eleanor','mama','papa','magpie')
e
e+5
e+5=4
test(e+5=4)
test(e+5,4)
e_6
e+6
r<-c(6,4,32,34,I(1/12))
r
r+2
r+1
plot(r)
hist(r)
hist(r,binwidth=0.1)
qplot(r,binwidth=0.1)
qplot(r,bin=0.1)
library(ggplot2)
qplot(r,binwidth=0.1)
cars
plot(cars)
head(cars)
hist(cars)
hist(cars$speed)
hist(cars$dist)
